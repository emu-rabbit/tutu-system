{"version":3,"file":"js/914.cabc1601.js","mappings":"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","sources":["webpack://cute-owner/./src/views/Register.vue?05be","webpack://cute-owner/./src/views/Register.vue?d0af","webpack://cute-owner/./src/views/Register.vue","webpack://cute-owner/./node_modules/@simplewebauthn/browser/dist/bundle/index.js"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, unref as _unref, normalizeClass as _normalizeClass, createVNode as _createVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, resolveComponent as _resolveComponent, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = /*#__PURE__*/_createElementVNode(\"h1\", null, \"兔兔註冊系統\", -1)\n\nimport { generateRegisterOptions, verifyRegister } from '@/apis/Auth'\r\nimport { ref } from 'vue'\r\nimport { startRegistration } from '@simplewebauthn/browser'\r\nimport { Field, Button, showNotify } from 'vant'\r\nimport { useRouter } from 'vue-router'\r\n\r\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'Register',\n  setup(__props) {\n\r\nconst router = useRouter()\r\n\r\nconst email = ref('')\r\nconst username = ref('')\r\nconst register = async () => {\r\n    try {\r\n        const { data: options } = await generateRegisterOptions({ email: email.value, username: username.value })\r\n        const attResp = await startRegistration(options)\r\n        await verifyRegister(attResp)\r\n        showNotify({\r\n            message: '註冊成功，可以登入了',\r\n            type: 'primary'\r\n        })\r\n        router.push('/auth/login')\r\n    } catch (e) {\r\n        // TODO already registered\r\n        console.log(e)\r\n        showNotify({\r\n            message: '註冊失敗',\r\n            type: 'primary'\r\n        })\r\n    }\r\n}\r\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_RouterLink = _resolveComponent(\"RouterLink\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass([\"centralize-container\", _ctx.$style.container])\n  }, [\n    _hoisted_1,\n    _createVNode(_unref(Field), {\n      modelValue: email.value,\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((email).value = $event)),\n      class: _normalizeClass(_ctx.$style.control),\n      type: \"email\",\n      label: \"Email\"\n    }, null, 8, [\"modelValue\", \"class\"]),\n    _createVNode(_unref(Field), {\n      modelValue: username.value,\n      \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((username).value = $event)),\n      class: _normalizeClass(_ctx.$style.control),\n      type: \"text\",\n      label: \"暱稱\"\n    }, null, 8, [\"modelValue\", \"class\"]),\n    _createVNode(_unref(Button), {\n      round: true,\n      class: _normalizeClass(_ctx.$style.control),\n      type: \"primary\",\n      onClick: register\n    }, {\n      default: _withCtx(() => [\n        _createTextVNode(\" 註冊 \")\n      ]),\n      _: 1\n    }, 8, [\"class\"]),\n    _createVNode(_component_RouterLink, { to: \"/auth/login\" }, {\n      default: _withCtx(() => [\n        _createTextVNode(\"有帳號了？前往登入！\")\n      ]),\n      _: 1\n    })\n  ], 2))\n}\n}\n\n})","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"Register_container_ZH1It\",\"control\":\"Register_control_RU1RJ\"};","import script from \"./Register.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./Register.vue?vue&type=script&lang=ts&setup=true\"\n\nconst cssModules = {}\nimport style0 from \"./Register.vue?vue&type=style&index=0&id=2d9537c3&lang=scss&module=true\"\ncssModules[\"$style\"] = style0\n\nimport exportComponent from \"C:\\\\Users\\\\immor\\\\Documents\\\\SourceTree\\\\cute-owner\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__cssModules',cssModules]])\n\nexport default __exports__","/* [@simplewebauthn/browser@7.0.0] */\nfunction utf8StringToBuffer(value) {\n    return new TextEncoder().encode(value);\n}\n\nfunction bufferToBase64URLString(buffer) {\n    const bytes = new Uint8Array(buffer);\n    let str = '';\n    for (const charCode of bytes) {\n        str += String.fromCharCode(charCode);\n    }\n    const base64String = btoa(str);\n    return base64String.replace(/\\+/g, '-').replace(/\\//g, '_').replace(/=/g, '');\n}\n\nfunction base64URLStringToBuffer(base64URLString) {\n    const base64 = base64URLString.replace(/-/g, '+').replace(/_/g, '/');\n    const padLength = (4 - (base64.length % 4)) % 4;\n    const padded = base64.padEnd(base64.length + padLength, '=');\n    const binary = atob(padded);\n    const buffer = new ArrayBuffer(binary.length);\n    const bytes = new Uint8Array(buffer);\n    for (let i = 0; i < binary.length; i++) {\n        bytes[i] = binary.charCodeAt(i);\n    }\n    return buffer;\n}\n\nfunction browserSupportsWebAuthn() {\n    return ((window === null || window === void 0 ? void 0 : window.PublicKeyCredential) !== undefined && typeof window.PublicKeyCredential === 'function');\n}\n\nfunction toPublicKeyCredentialDescriptor(descriptor) {\n    const { id } = descriptor;\n    return {\n        ...descriptor,\n        id: base64URLStringToBuffer(id),\n        transports: descriptor.transports,\n    };\n}\n\nfunction isValidDomain(hostname) {\n    return (hostname === 'localhost' || /^([a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}$/i.test(hostname));\n}\n\nclass WebAuthnError extends Error {\n    constructor(message, name = 'WebAuthnError') {\n        super(message);\n        this.name = name;\n    }\n}\n\nfunction identifyRegistrationError({ error, options, }) {\n    var _a, _b;\n    const { publicKey } = options;\n    if (!publicKey) {\n        throw Error('options was missing required publicKey property');\n    }\n    if (error.name === 'AbortError') {\n        if (options.signal === new AbortController().signal) {\n            return new WebAuthnError('Registration ceremony was sent an abort signal', 'AbortError');\n        }\n    }\n    else if (error.name === 'ConstraintError') {\n        if (((_a = publicKey.authenticatorSelection) === null || _a === void 0 ? void 0 : _a.requireResidentKey) === true) {\n            return new WebAuthnError('Discoverable credentials were required but no available authenticator supported it', 'ConstraintError');\n        }\n        else if (((_b = publicKey.authenticatorSelection) === null || _b === void 0 ? void 0 : _b.userVerification) === 'required') {\n            return new WebAuthnError('User verification was required but no available authenticator supported it', 'ConstraintError');\n        }\n    }\n    else if (error.name === 'InvalidStateError') {\n        return new WebAuthnError('The authenticator was previously registered', 'InvalidStateError');\n    }\n    else if (error.name === 'NotAllowedError') {\n        return new WebAuthnError('User clicked cancel, or the registration ceremony timed out', 'NotAllowedError');\n    }\n    else if (error.name === 'NotSupportedError') {\n        const validPubKeyCredParams = publicKey.pubKeyCredParams.filter(param => param.type === 'public-key');\n        if (validPubKeyCredParams.length === 0) {\n            return new WebAuthnError('No entry in pubKeyCredParams was of type \"public-key\"', 'NotSupportedError');\n        }\n        return new WebAuthnError('No available authenticator supported any of the specified pubKeyCredParams algorithms', 'NotSupportedError');\n    }\n    else if (error.name === 'SecurityError') {\n        const effectiveDomain = window.location.hostname;\n        if (!isValidDomain(effectiveDomain)) {\n            return new WebAuthnError(`${window.location.hostname} is an invalid domain`, 'SecurityError');\n        }\n        else if (publicKey.rp.id !== effectiveDomain) {\n            return new WebAuthnError(`The RP ID \"${publicKey.rp.id}\" is invalid for this domain`, 'SecurityError');\n        }\n    }\n    else if (error.name === 'TypeError') {\n        if (publicKey.user.id.byteLength < 1 || publicKey.user.id.byteLength > 64) {\n            return new WebAuthnError('User ID was not between 1 and 64 characters', 'TypeError');\n        }\n    }\n    else if (error.name === 'UnknownError') {\n        return new WebAuthnError('The authenticator was unable to process the specified options, or could not create a new credential', 'UnknownError');\n    }\n    return error;\n}\n\nclass WebAuthnAbortService {\n    createNewAbortSignal() {\n        if (this.controller) {\n            this.controller.abort('Cancelling existing WebAuthn API call for new one');\n        }\n        const newController = new AbortController();\n        this.controller = newController;\n        return newController.signal;\n    }\n}\nconst webauthnAbortService = new WebAuthnAbortService();\n\nconst attachments = ['cross-platform', 'platform'];\nfunction toAuthenticatorAttachment(attachment) {\n    if (!attachment) {\n        return;\n    }\n    if (attachments.indexOf(attachment) < 0) {\n        return;\n    }\n    return attachment;\n}\n\nasync function startRegistration(creationOptionsJSON) {\n    var _a;\n    if (!browserSupportsWebAuthn()) {\n        throw new Error('WebAuthn is not supported in this browser');\n    }\n    const publicKey = {\n        ...creationOptionsJSON,\n        challenge: base64URLStringToBuffer(creationOptionsJSON.challenge),\n        user: {\n            ...creationOptionsJSON.user,\n            id: utf8StringToBuffer(creationOptionsJSON.user.id),\n        },\n        excludeCredentials: (_a = creationOptionsJSON.excludeCredentials) === null || _a === void 0 ? void 0 : _a.map(toPublicKeyCredentialDescriptor),\n    };\n    const options = { publicKey };\n    options.signal = webauthnAbortService.createNewAbortSignal();\n    let credential;\n    try {\n        credential = (await navigator.credentials.create(options));\n    }\n    catch (err) {\n        throw identifyRegistrationError({ error: err, options });\n    }\n    if (!credential) {\n        throw new Error('Registration was not completed');\n    }\n    const { id, rawId, response, type } = credential;\n    let transports = undefined;\n    if (typeof response.getTransports === 'function') {\n        transports = response.getTransports();\n    }\n    return {\n        id,\n        rawId: bufferToBase64URLString(rawId),\n        response: {\n            attestationObject: bufferToBase64URLString(response.attestationObject),\n            clientDataJSON: bufferToBase64URLString(response.clientDataJSON),\n            transports,\n        },\n        type,\n        clientExtensionResults: credential.getClientExtensionResults(),\n        authenticatorAttachment: toAuthenticatorAttachment(credential.authenticatorAttachment),\n    };\n}\n\nfunction bufferToUTF8String(value) {\n    return new TextDecoder('utf-8').decode(value);\n}\n\nasync function browserSupportsWebAuthnAutofill() {\n    const globalPublicKeyCredential = window.PublicKeyCredential;\n    return (globalPublicKeyCredential.isConditionalMediationAvailable !== undefined &&\n        globalPublicKeyCredential.isConditionalMediationAvailable());\n}\n\nfunction identifyAuthenticationError({ error, options, }) {\n    var _a;\n    const { publicKey } = options;\n    if (!publicKey) {\n        throw Error('options was missing required publicKey property');\n    }\n    if (error.name === 'AbortError') {\n        if (options.signal === new AbortController().signal) {\n            return new WebAuthnError('Authentication ceremony was sent an abort signal', 'AbortError');\n        }\n    }\n    else if (error.name === 'NotAllowedError') {\n        if ((_a = publicKey.allowCredentials) === null || _a === void 0 ? void 0 : _a.length) {\n            return new WebAuthnError('No available authenticator recognized any of the allowed credentials', 'NotAllowedError');\n        }\n        return new WebAuthnError('User clicked cancel, or the authentication ceremony timed out', 'NotAllowedError');\n    }\n    else if (error.name === 'SecurityError') {\n        const effectiveDomain = window.location.hostname;\n        if (!isValidDomain(effectiveDomain)) {\n            return new WebAuthnError(`${window.location.hostname} is an invalid domain`, 'SecurityError');\n        }\n        else if (publicKey.rpId !== effectiveDomain) {\n            return new WebAuthnError(`The RP ID \"${publicKey.rpId}\" is invalid for this domain`, 'SecurityError');\n        }\n    }\n    else if (error.name === 'UnknownError') {\n        return new WebAuthnError('The authenticator was unable to process the specified options, or could not create a new assertion signature', 'UnknownError');\n    }\n    return error;\n}\n\nasync function startAuthentication(requestOptionsJSON, useBrowserAutofill = false) {\n    var _a, _b;\n    if (!browserSupportsWebAuthn()) {\n        throw new Error('WebAuthn is not supported in this browser');\n    }\n    let allowCredentials;\n    if (((_a = requestOptionsJSON.allowCredentials) === null || _a === void 0 ? void 0 : _a.length) !== 0) {\n        allowCredentials = (_b = requestOptionsJSON.allowCredentials) === null || _b === void 0 ? void 0 : _b.map(toPublicKeyCredentialDescriptor);\n    }\n    const publicKey = {\n        ...requestOptionsJSON,\n        challenge: base64URLStringToBuffer(requestOptionsJSON.challenge),\n        allowCredentials,\n    };\n    const options = {};\n    if (useBrowserAutofill) {\n        if (!(await browserSupportsWebAuthnAutofill())) {\n            throw Error('Browser does not support WebAuthn autofill');\n        }\n        const eligibleInputs = document.querySelectorAll(\"input[autocomplete*='webauthn']\");\n        if (eligibleInputs.length < 1) {\n            throw Error('No <input> with `\"webauthn\"` in its `autocomplete` attribute was detected');\n        }\n        options.mediation = 'conditional';\n        publicKey.allowCredentials = [];\n    }\n    options.publicKey = publicKey;\n    options.signal = webauthnAbortService.createNewAbortSignal();\n    let credential;\n    try {\n        credential = (await navigator.credentials.get(options));\n    }\n    catch (err) {\n        throw identifyAuthenticationError({ error: err, options });\n    }\n    if (!credential) {\n        throw new Error('Authentication was not completed');\n    }\n    const { id, rawId, response, type } = credential;\n    let userHandle = undefined;\n    if (response.userHandle) {\n        userHandle = bufferToUTF8String(response.userHandle);\n    }\n    return {\n        id,\n        rawId: bufferToBase64URLString(rawId),\n        response: {\n            authenticatorData: bufferToBase64URLString(response.authenticatorData),\n            clientDataJSON: bufferToBase64URLString(response.clientDataJSON),\n            signature: bufferToBase64URLString(response.signature),\n            userHandle,\n        },\n        type,\n        clientExtensionResults: credential.getClientExtensionResults(),\n        authenticatorAttachment: toAuthenticatorAttachment(credential.authenticatorAttachment),\n    };\n}\n\nasync function platformAuthenticatorIsAvailable() {\n    if (!browserSupportsWebAuthn()) {\n        return false;\n    }\n    return PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();\n}\n\nexport { browserSupportsWebAuthn, browserSupportsWebAuthnAutofill, platformAuthenticatorIsAvailable, startAuthentication, startRegistration };\n"],"names":["_hoisted_1","_createElementVNode","_defineComponent","__name","setup","__props","router","useRouter","email","ref","username","register","async","data","options","generateRegisterOptions","value","attResp","startRegistration","verifyRegister","showNotify","message","type","push","e","console","log","_ctx","_cache","_component_RouterLink","_resolveComponent","_openBlock","_createElementBlock","class","_normalizeClass","$style","container","_createVNode","_unref","Field","modelValue","$event","control","label","Button","round","onClick","default","_withCtx","_createTextVNode","_","to","cssModules","__exports__","utf8StringToBuffer","TextEncoder","encode","bufferToBase64URLString","buffer","bytes","Uint8Array","str","charCode","String","fromCharCode","base64String","btoa","replace","base64URLStringToBuffer","base64URLString","base64","padLength","length","padded","padEnd","binary","atob","ArrayBuffer","i","charCodeAt","browserSupportsWebAuthn","undefined","window","PublicKeyCredential","toPublicKeyCredentialDescriptor","descriptor","id","transports","isValidDomain","hostname","test","WebAuthnError","Error","constructor","name","super","this","identifyRegistrationError","error","_a","_b","publicKey","signal","AbortController","authenticatorSelection","requireResidentKey","userVerification","validPubKeyCredParams","pubKeyCredParams","filter","param","effectiveDomain","location","rp","user","byteLength","WebAuthnAbortService","createNewAbortSignal","controller","abort","newController","webauthnAbortService","attachments","toAuthenticatorAttachment","attachment","indexOf","creationOptionsJSON","challenge","excludeCredentials","map","credential","navigator","credentials","create","err","rawId","response","getTransports","attestationObject","clientDataJSON","clientExtensionResults","getClientExtensionResults","authenticatorAttachment","bufferToUTF8String","TextDecoder","decode","browserSupportsWebAuthnAutofill","globalPublicKeyCredential","isConditionalMediationAvailable","identifyAuthenticationError","allowCredentials","rpId","startAuthentication","requestOptionsJSON","useBrowserAutofill","eligibleInputs","document","querySelectorAll","mediation","get","userHandle","authenticatorData","signature"],"sourceRoot":""}